# DropIt一键整理文件

[DropIt官网](http://www.dropitproject.com/)

[简体中文](http://www.dropitproject.com/download.php?lng=SimplifiedChinese)

### 过滤文件的规则

名字，目录，

大小，日期，属性，

内容或者正则表达式



### 关联 18 个可用的选项

移动，复制，

压缩，提取，

重命名，删除，

加密，打开为，上传，用邮件发送，创建图库，创建列表，创建播播放列表，创建快捷键，复制到剪贴板，修改属性和忽略

### 用户还可以定义一段时间间隔来组织联系资料和自动扫描监控文件夹。

## 配置文件（Profiles）：

配置文件，可以看作单个协议的文件夹。我们可以通过它将协议归类，并且导出，用于分享。

> 在 DropIt 的配置文件中，协议没有先后顺序，
>
> 一个文件每次只会应用一条协议，
>
> 符合一条规则之后执行对应的操作，
>
> 所以无法用来做工作流。

与其说它是一条生产线，倒不如说是一个分拣工具。

## 协议（Associations）：

一条协议由名称、规则、操作、具体配置这 4 个部分组成。

1. 名称是指这条协议的名字；
2. 规则是适用的文件类型，以分号隔开，比如我只想对压缩包文件操作，那规则就是 *.rar;*.zip;*.7z；
3. 操作是你想对文件进行的动作，比如「重命名」「移动」等；
4. 最后是这个操作的具体配置，不同的操作有不同的配置选项；

## 自定义协议

点击加号，在协议里面配置相应的处理规则

<img src="https://pic3.zhimg.com/v2-1712847701b32494603d8a5eff051b1e_r.jpg" alt="img" style="zoom: 50%;" />

**下面我来设置一个音乐协议**填写名称，**选择规则**（规则也可以自己写）

<img src="https://pic4.zhimg.com/v2-2d9b1a6c9524a3a0c6b915cce925fb97_r.jpg" alt="img" style="zoom:50%;" />

选择操作为：移动

<img src="https://pic3.zhimg.com/v2-4e839f7dd870dadf7160852746d8e1be_r.jpg" alt="img" style="zoom:50%;" />

目标文件夹：填写「**音乐**」即可

<img src="https://pic4.zhimg.com/v2-e52e6be533c3bae6d121d9b0af0becd7_r.jpg" alt="img" style="zoom:50%;" />

**按照该方法，新建其他协议**表格

<img src="https://pic2.zhimg.com/v2-315416c2e2fb4037ef0fe1e5f617e201_r.jpg" alt="img" style="zoom:50%;" />

图片

<img src="https://pic2.zhimg.com/v2-94a957b8220f6071d508c6d3527a1df1_r.jpg" alt="img" style="zoom:50%;" />

文档

<img src="https://pic4.zhimg.com/v2-d98f859f1b419d90bd75786ca40f6b23_r.jpg" alt="img" style="zoom:50%;" />

完成

<img src="https://pic1.zhimg.com/v2-0b59965aea8063dee86c883f89d8b348_r.jpg" alt="img" style="zoom:50%;" />

通过上面一系列的操作，现在它的作用就是：**需要处理的内容中如果有图片，就在当前路径下新建一个文件夹，命名为图片，然后把图片都放在该文件夹里面。**

## 快速调用



DropIt 提供了 2 种调用方式：

- 将文件拖到图标上，执行：
- 选中文件，「右键 - 发送到 - 具体动作」。

这个快捷菜单的出现，让 DropIt 不必长期运行，不需要开机启动，也能像使用系统自带的功能一样进行快捷操作。



DropIt 在执行命令前，会扫描一遍文件，并把即将做的操作汇报一遍。确认后才会执行。



如果你希望点击按钮后立即执行任务，可以在设置中勾选「加载好后立即开始处理」。这样就无需再次确认了。

## 配合 IrfanView 对图片进行操作

DropIt 不仅可以单独执行，还能配合其他支持命令行的软件一起使用。

**这里推荐一款知名命令行图片处理工具** [IrfanView](https://www.irfanview.com/)**。**

**DropIt 和 Irfanview 结合恰好可以帮我完成这些工作，对图片进行简单的批量处理。**



 IrfanView不仅是一个仅有 1.6 MB 大小的图片浏览、转换、编辑工具，

它还支持各种命令行操作，IrfanView 在根目录下提供了一个 i_options.txt 文件，

里面列出了所有支持的命令行选项。

### 配合 DropIt 使用，批量处理图片

我们需要在 DropIt 配置文件中新增一个协议，配置如下：

1. 名称：批量清除 EXIF 信息
2. 规则：*.bmp;*.gif;*.hdr;*.ico;*.jpeg;*.jpg;*.png;*.psd;*.tif;*.tiff;
3. 操作：打开方式
4. 目标程序：`"C:\Program Files\IrfanView\i_view64.exe" "%File%"/jpg_rotate=(0,1,0,1,0,0,1,0)/cmdexit`

最后这段命令的意思："C:\Program Files\IrfanView\i_view64.exe" 是 IrfanView 的安装目录，

如果你使用的是绿色版，需要修改到它的位置。

"%File%" 是 DropIt 内置的变量，意思是「不包含扩展名的文件名」，这些内置变量是可以直接选择的，不用记住。

`/jpg_rotate=(0,1,0,1,0,0,1,0)` 是 IrfanView 的提供选项，0 和 1 分别代表不同选项的开关。

第 7 项的 1 是「清除全部标记」，第 8 项的 0 是「不保留 EXIF」。

其他选项的意思可以在 i_options.txt 中查到，这里不做赘述。

cmdexit 是指执行完操作后，自动关闭窗口。

这个操作会覆盖原图，所以在尝试执行前对照片做好备份。

**你可以在这里下载** [清除图片 EXIF 的配置文件](https://cdn.sspai.com/清除图片EXIF（需要安装 IrfanViewer）.ini)。

### 将 PSD 源文件批量转换为 PNG 图片

**很多图片转换工具仅提供图片格式之间的互相转换，比如 JPG 转 PNG、GIF 转 JPG 等。**

**但是面对 PSD 这种格式的文件，很多图片转换工具就无能为力了。一个一个打开 PSD 再逐个保存，实在是件麻烦事。**

先在 i_options.txt 文件找到图片格式转换的指令——

```bash
i_view32.exe c:test.bmp /convert=c:giftest.gif
```

解释一下这段代码：使用 IrfanView 工具，将 C 盘中的 test.bmp 文件转换为 giftest.gif 文件。

把这段代码放进 DropIt 中，稍作修改，就变成了一个新的配置文件——

1. 名称：批量转换图片格式
2. 规则：.bmp;*.gif;*.hdr;*.ico;*.jp2;*.jpe;*.jpeg;*.jpg;*.png;*.psd;
3. 操作：打开方式
4. 目标程序：

```yaml
"C:\Program Files\IrfanView\i_view64.exe" "%File% /convert=%ParentDir%\%FileName%.png"
```

**你可以在这里下载** [图片转换的配置文件](https://cdn.sspai.com/图片格式转换（需要安装 IrfanViewer）.ini)**。**

### 「检测文件内容」分拣

拿我这段时间经常用到的 `*.md` 文件举例，这些主要分为三种——写稿、改稿、派早报。那么最符合我习惯的分拣策略是「将这三种 md 文件归类到对应的文件夹，其他的 md 文件放在原处」。

所以我在一个配置文件中，制定了三条协议，只有目标位置有所不同——

1. 名称：Markdown 文稿分类
2. 规则：*.md;*.txt;*.doc;*.docx;*.epub;*.odt;*.pdf;*.rtf;*.tex
3. 操作：移动
4. 目标：

```
"%ParentDir%\写稿"
"%ParentDir%\改稿"
"%ParentDir%\派早报"
```

不过只是这样做显然会产生冲突，因为 DropIt 无从判断应该放进哪一个文件夹，所以在「规则」中还需要添加一些筛选条件。

<img src="https://cdn.sspai.com/2018/04/03/8442705ca942de362db8b7cdfec8b9a0.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1" alt="img" style="zoom:50%;" />

**在 DropIt 的操作中提供了一项「检测文件内容」，简直是懒人的神器。只需要在三个规则中各添加一个「写稿」「改稿」「派早报」的关键词，它在分拣时就会自动识别 Markdown 文档中的内容是否包含这几个关键词，然后将符合关键词的文件，放进指定的文件夹。**

经过测试，这项功能适用于



-  `*.TXT;*.MD;` 等纯文本文档，
- 也支持 `*.DOC;*.DOCX;*.CSV;*.PDF` 这类以文字为主的文档，
- `*.XLS` 则不支持，这与 Excel 的存储形式有关。

### 提高特定协议的优先级

在一个配置文件中可以设定多条协议来筛选文件，

但 多条协议之间可能会产生冲突，比如设置 *.jpg 文件移动到子文件夹，又设置 *.jpg 文件放进压缩包。

如果运行这个配置文件，它会在扫描文件阶段出现一个提示项，真正执行前让你再做一次选择。

简而言之，DropIt 采用的是「一个文件一次应用一条协议」。

当这些协议有冲突之处时，

- 可以在配置文件中提高某条协议的优先级（右上角的星号），
- 或是在规则一栏添加 # 和 ## 来区分文件和文件夹，变相提高了协议的优先级。
- 如果没有指定优先级，在执行任务时也可以手动选择。

在上面这个例子中，通过三条协议完成细致的划分之后，需要 提高这三条协议的优先级，让它们优先执行。

此外，还需再添加一项通用协议，让其余的 `*.md` 文件留在原地。这样就可以使适用范围更广，实现全自动的精细化分拣了。

**你可以在这里下载** [一键分类少数派稿件](https://cdn.sspai.com/一键分类少数派稿件.ini)**。**

## 批量进行压缩加密操作

压缩包是我们经常用的一种文件形式，

可以将不用的文件打包为一个文件，归档存放起来。

但是在几乎所有的压缩包软件中，只能实现「选中文件 - 压缩」这样的两步操作。

如果我想把超过一个月的文件打包起来，是不是要先挨个查看一遍文件？

如果我想把重要的工作文档加密保存，是不是需要一个一个输入密码，打包压缩？

### 批量压缩 & 提取所有压缩文件

在 DropIt 中，你可以很快完成这些工作，

比如直接设置一项「访问时间 > 7 天」来对这些文件进行处理，或是批量对文件进行加密。

想要批量完成压缩操作，我有两种常用的方法。

只需在操作中选择「压缩」，在目标文件夹输入框中输入：

- %ParentDir%\%ParentDirName%.7z，将所有选中的文件打包进同一个压缩包文件。
- %ParentDir%\%FileName%.7z，为每一个文件创建一个加密压缩包。

至于解压缩功能，DropIt 除了支持 `7z、RAR、ZIP` 等常见的压缩包格式，

还支持 `DMG、ISO、WIM、VHD` 等多达 38 种的归档文件格式。

如果有什么压缩包文件是你目前使用的解压缩软件无法打开的，不如用 DropIt 试一试。

### 批量加密和解密

**DropIt 提供了两种对文件进行加密的思路，**

- **一种是传统的 7z 压缩包加密方法，**
- **另一种是安全性更高的 AES 加密法。**



1. **在操作中选择「加密」，**
2. **并在左侧输入密码，**
3. **还可以选择「处理完成后，删除源文件」，**

**这样就可以将加密文件安全地储存起来。**

7z 的压缩加密方式与常规的压缩包无异，我通常用 7z 来归档一些不适合直接放在电脑中显示的文件。

- 如果你需要更高的安全性，也可以选择 AES-256、RC4 等其他加密方法，
- 使用这种加密方式时，会生成 fcrt 格式的加密文件，
- 解密时也需要用到 DropIt 的解密操作，适用范围就小了很多，

因此推荐采用 7z 的加密方式。

你可以在这里下载 [加密 & 解密的配置文件](https://cdn.sspai.com/加密&解密文件.ini)，加密的默认密码为 123，可以自行在协议中进行修改。

## 如何使用别人的配置文件

**首先找到 DropIt 的安装目录，默认位置是** `C:\Program Files\DropIt\`**。**

**它的配置文件存放在这个目录下的 `Profiles` 文件夹中，

**也就是** `C:\Program Files\DropIt\Profiles\` **目录中，**

**再打开 DropIt 就可以看到配置文件了。**

## 规则

支持对文件名的过滤，但需要自己手工建立规则。
帮助里有：不知道大家能不能合力建一个规则表来。

```yml
支持文件的示例模式规则: *.jpg = 所有 “jpg” 扩展名文件
penguin.* =所有名为 “penguin”的文件
penguin*.* = 所有 “penguin” 开头的文件
*penguin* = 所有包含 “penguin”的文件

支持文件夹的示例模式规则:
robot** = 所有 “robot” 开头的文件夹
**robot = 所有”robot”结尾的文件夹

**robot** = 所有包含 “robot”的文件夹

在一个单独的几个规则与模式 “;” 到
建立多模式的规则 (例如: *.jpg;*.png ).
```



这个软件可以根据正则式或者内置环境变量进行自定义配置规则的。
举个栗子：把音乐文件按歌手\专辑分文件夹。在自定义配置中把目标文件夹改成

```tcl
%ParentDir%\%SongArtist%\%SongAlbum%
```

就OK了



使用“../”就是上级目录的意思





其实规则可以用正则表达式取，但是保存时的目标文夹不能用正则阿，想按文件名中的某个字符自动创建文件夹都不行

居然是一个ＡＵ３脚本，官风上有源码可以下载！

自己用everything搜索后缀手动分类也行。

投稿，推荐文件整理工具,File Punter
可用正则，可保存规则，个人觉得完美。

totalcmd里有个插件mover可以分类文件夹管理文件.

资源管理器替代类都可以过滤后缀名吧
用了好多现在觉的小众推荐的mdie最好，定制性非常高
尤其是支持鼠标手势

希望各操作系统普及 tag 的应用，那样通过搜索就可以找到需要的文件，通过虚拟搜索分类文件，就不用这么麻烦了。

[用 DropIt 打造全自动的 Windows 文件管理体系](https://sspai.com/post/45532)

 [DropIt – 文件分类利器](https://www.appinn.com/dropit/)

[一键自动文件归类，效率神器「DropIt」，详细使用教程](https://zhuanlan.zhihu.com/p/136799383)

